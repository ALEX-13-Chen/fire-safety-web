<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>火災隱患專家系統</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* 更現代的字體 */
            margin: 0;
            padding-top: 80px;
            background: #f4f6f8; /* 更柔和的背景色 */
            color: #333; /* 更深的文字顏色 */
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }
        nav {
            background-color: #2c3e50; /* 深色背景 */
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            padding: 15px 20px;
            display: flex; /* 使用 flex 佈局 */
            align-items: center;
        }

        nav > a:first-child { /* 主頁面 */
            margin-right: 20px; /* 與回上題按鈕的間距 */
        }

        nav a {
            text-decoration: none;
            color: #eee;
            padding: 10px 15px;
            border-radius: 5px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        nav a:hover {
            background-color: #34495e;
            color: #fff;
        }
        .quiz-container, .results-container {
            background-color: #fff;
            border-radius: 8px;
            padding: 40px;
            margin: 30px auto;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); /* 更柔和的陰影 */
            max-width: 600px;
        }
        .quiz-container h2, .results-container h2 {
            color: #3498db; /* 藍色主色調 */
            margin-top: 0;
            margin-bottom: 20px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .question {
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600; /* 更粗的字重 */
        }
        .options label {
            display: block;
            margin-bottom: 12px;
        }
        .options input[type="radio"] {
            margin-right: 8px;
        }
        .next-button, .prev-button, .results-container .next-button {
            background-color: #2ecc71; /* 綠色按鈕 */
            color: white;
            border: none;
            border-radius: 5px;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 20px;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-decoration: none; /* 確保結果頁面按鈕沒有底線 */
            display: inline-block; /* 確保結果頁面按鈕是 inline-block */
        }
        .prev-button {
            background-color: #7f8c8d; /* 灰色上一步按鈕 */
            margin-right: 10px;
        }
        .next-button:hover, .results-container .next-button:hover {
            background-color: #27ae60;
        }
        .prev-button:hover {
            background-color: #616a6b;
        }
        .hidden {
            display: none !important;
        }
        .results-container h2 {
            color: #2ecc71; /* 結果頁面標題顏色 */
        }
        .risk-level {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #e67e22; /* 風險等級顏色 */
        }
        .recommendations h3 {
            color: #3498db;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .recommendations ul {
            padding-left: 20px;
            list-style-type: disc; /* 確保顯示項目符號 */
        }
        .recommendations li {
            margin-bottom: 15px; /* 增加垂直間距 */
            line-height: 1.7; /* 增加行高 */
        }
        .recommendation-text {
            color: #007bff; /* 您選擇的顏色 */
            font-weight: normal;
            display: inline; /* 讓建議文字與問題在同一行 */
            margin-left: 10px; /* 增加問題和建議之間的間距 */
        }
        .recommendations li > span:first-child { /* 問題文字 */
            font-weight: bold;
            color: #333;
        }

        /* 黑色護眼模式樣式 */
        .dark-mode {
            background-color: #000 !important;
            color: #ffe207 !important;
        }
        .dark-mode nav {
            background-color: #333 !important;
            box-shadow: 0 2px 5px rgba(255, 255, 255, 0.05);
        }
        .dark-mode nav a {
            color: #f0ad4e !important;
        }
        .dark-mode nav a:hover {
            background-color: #555 !important;
            color: #fff !important;
        }
        .dark-mode .quiz-container, .dark-mode .results-container {
            background-color: #3d3939 !important;
            box-shadow: 10 6px 12px rgba(223, 199, 199, 0.05);
        }
        .dark-mode .quiz-container h2, .dark-mode .results-container h2, .dark-mode .recommendations h3 {
            color: #ff8c00ef !important;
            border-bottom-color: #ffc005 !important;
        }
        .dark-mode .question, .dark-mode .options label{
            color: #f1e101 !important;
        }
        .dark-mode .recommendation-text{
            color: #f43636 !important;
        }
        .dark-mode .dark-mode .risk-level{
            color: #fb5400e5 !important;
        }
        .dark-mode .next-button, .dark-mode .prev-button, .dark-mode .results-container .next-button {
            background-color: #006d3a !important; /* 更深的按鈕背景 */
            color: #eee !important;
            box-shadow: 10 2px 4px rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body>
    <button id="toggleDarkMode" style="position: fixed; top: 20px; right: 20px; z-index: 101; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; background-color: #f0f0f0; color: #333;">切換護眼模式</button>
    <nav>
        <a href="index.html">主頁面</a>
        <a href="#" id="prev-question" class="hidden">回上題</a>
    </nav>

    <div id="quiz-container" class="quiz-container">
        <h2>火災隱患測驗</h2>
        <div id="question-container">
            </div>
        <div id="navigation-buttons">
            <button id="next-button" class="next-button">下一步</button>
        </div>
    </div>

    <div id="results-container" class="results-container hidden">
        <h2>測驗結果</h2>
        <div id="risk-level" class="risk-level"></div>
        <div id="recommendations"></div>
        <a href="index.html" class="next-button">回到主頁面</a>
    </div>

    <script>
        const quizContainer = document.getElementById('quiz-container');
        const questionContainer = document.getElementById('question-container');
        const nextButton = document.getElementById('next-button');
        const prevButton = document.getElementById('prev-question');
        const resultsContainer = document.getElementById('results-container');
        const riskLevelDisplay = document.getElementById('risk-level');
        const recommendationsDisplay = document.getElementById('recommendations');

        let currentQuestionIndex = 0;
        let userAnswers = [];
        const questions = [
            {
                question: "您家中是否經常同時使用多個高功率電器？",
                options: ["從不", "偶爾", "經常"],
                weights: [0, 1, 3],
                recommendation: "避免同時使用多個高功率電器，以防電線過載。"
            },
            {
                question: "您是否定期檢查家中電線是否有老化或破損？",
                options: ["是，經常", "偶爾", "否"],
                weights: [0, 1, 2],
                recommendation: "定期檢查電線，如有老化或破損應立即更換。"
            },
            {
                question: "您家中的瓦斯管線是否定期檢查？",
                options: ["是", "否"],
                weights: [0, 2],
                recommendation: "定期請專業人員檢查瓦斯管線，確保安全。"
            },
            {
                question: "您是否清楚家中逃生路線和滅火器的位置？",
                options: ["非常清楚", "大概知道", "不清楚"],
                weights: [0, 1, 3],
                recommendation: "熟悉家中逃生路線，並確認滅火器可隨時使用。"
            },
            {
                question: "您是否會在睡前或外出時檢查電器和瓦斯是否關閉？",
                options: ["總是", "偶爾", "從不"],
                weights: [0, 1, 3],
                recommendation: "養成睡前或外出時檢查電器和瓦斯是否關閉的習慣。"
            },
            {
                question: "您家中是否有安裝住宅用火災警報器？",
                options: ["有", "沒有"],
                weights: [0, 3],
                recommendation: "建議安裝住宅用火災警報器，以便及早發現火情。"
            }
        ];

        function showQuestion() {
            const currentQuestion = questions[currentQuestionIndex];
            questionContainer.innerHTML = `
                <div class="question">${currentQuestion.question}</div>
                <div class="options">
                    ${currentQuestion.options.map((option, index) => `
                        <label><input type="radio" name="q${currentQuestionIndex}" value="${index}">${option}</label><br>
                    `).join('')}
                </div>
            `;

            // 顯示或隱藏「回上題」按鈕
            prevButton.classList.toggle('hidden', currentQuestionIndex === 0);
        }

        function nextQuestion() {
            const selectedOption = document.querySelector(`input[name="q${currentQuestionIndex}"]:checked`);
            if (!selectedOption) {
                alert('請選擇一個答案。');
                return;
            }
            userAnswers[currentQuestionIndex] = parseInt(selectedOption.value);
            currentQuestionIndex++;

            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            currentQuestionIndex--;
            showQuestion();
        }

        function calculateRisk() {
            let totalWeight = 0;
            let specificRecommendations = [];
            for (let i = 0; i < questions.length; i++) {
                if (userAnswers[i] !== undefined) {
                    totalWeight += questions[i].weights[userAnswers[i]];
                    // 如果選擇了風險較高的選項（這裡我們簡單判斷權重是否大於 0），則加入該問題的建議
                    if (questions[i].weights[userAnswers[i]] > 0) {
                        specificRecommendations.push(`<li><span>${questions[i].question}</span> <span class="recommendation-text">- ${questions[i].recommendation}</span></li>`);
                    }
                }
            }

            let riskLevel = "";
            if (totalWeight <= 5) {
                riskLevel = "低風險";
            } else if (totalWeight <= 10) {
                riskLevel = "中風險";
            } else {
                riskLevel = "高風險";
            }

            return { level: riskLevel, score: totalWeight, recommendations: specificRecommendations };
        }

        function showResults() {
            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');
            const results = calculateRisk();
            riskLevelDisplay.textContent = `您的火災風險等級為：${results.level} (總分：${results.score})`;

            let recommendationsHTML = "<h3>改善建議：</h3><ul>" + results.recommendations.join('') + "</ul>";
            if (results.recommendations.length === 0) {
                recommendationsHTML = "<p>您的風險評估結果良好，請繼續保持！</p>";
            }
            recommendationsDisplay.innerHTML = recommendationsHTML;
        }

        nextButton.addEventListener('click', nextQuestion);
        prevButton.addEventListener('click', prevQuestion);

        showQuestion(); // 頁面載入時顯示第一個問題

        // 添加護眼模式切換的 JavaScript 邏輯
        const toggleDarkModeButton = document.getElementById('toggleDarkMode');
        const pageBody = document.body; // 直接使用 body 元素
        const darkModeClassName = 'dark-mode';

        toggleDarkModeButton.addEventListener('click', () => {
            pageBody.classList.toggle(darkModeClassName);
            if (pageBody.classList.contains(darkModeClassName)) {
                localStorage.setItem('darkMode', 'enabled');
                toggleDarkModeButton.textContent = '切換一般模式';
            } else {
                localStorage.setItem('darkMode', 'disabled');
                toggleDarkModeButton.textContent = '切換護眼模式';
            }
        });

        if (localStorage.getItem('darkMode') === 'enabled') {
            pageBody.classList.add(darkModeClassName);
            toggleDarkModeButton.textContent = '切換一般模式';
        }
    </script>
</body>
</html>
